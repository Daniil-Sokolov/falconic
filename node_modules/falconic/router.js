'use strict';
const fs = require('fs');
const path = require('path');


const STATIC_PATH = path.join(process.cwd(), './src/routes');
const watch = ()=> {
	fs.watch(STATIC_PATH, (e, f)=> {
		const props = Object.getOwnPropertyNames(routes);
		for (var i = 0; i < props.length; i++) delete routes[props[i]];
		paths = fs.readdirSync(path.join(process.cwd(), './src/routes'));
		for(let i in paths) delete require.cache[path.join(process.cwd(), `/src/routes/${paths[i]}`)];
		for(let i in paths) Object.assign(routes, require(path.join(process.cwd(), `/src/routes/${paths[i]}`)));
	})
}

const routes = {};
let paths = fs.readdirSync(path.join(process.cwd(), './src/routes'));
for(let i in paths) Object.assign(routes, require(path.join(process.cwd(), `/src/routes/${paths[i]}`)));

watch()

module.exports = routes;